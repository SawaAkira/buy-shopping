(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d5142b14"],{"49b9":function(t,e,s){"use strict";s("be92")},a686:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"userInfo"},[t.$store.state.isUserInfoShow?s("div",{staticClass:"userHeader"},[s("p",[t._v("管理我的账号")]),s("div",{staticClass:"userBox"},[s("label",{staticClass:"imgbox"},[s("img",{attrs:{src:t.image,alt:""}}),s("input",{ref:"image",attrs:{type:"file",name:"file",accept:"image/*"},on:{change:t.getPhoto}}),s("i",{staticClass:"bi bi-pencil-square"})]),s("div",{staticClass:"textBox"},[s("div",{staticClass:"userName"},[t._v(t._s(t.userInfo.nickname))]),s("div",{staticClass:"phone"},[t._v("绑定手机号："+t._s(t.userInfo.phone))])]),s("span",[t._v("当前账号")])])]):t._e(),t.$store.state.isUserInfoShow?s("div",{staticClass:"userMain"},[s("div",{staticClass:"name"},[s("span",[t._v("昵称")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],attrs:{type:"text",placeholder:"请输入昵称"},domProps:{value:t.userName},on:{input:function(e){e.target.composing||(t.userName=e.target.value)}}})]),s("div",{staticClass:"uid"},[s("span",[t._v("ID")]),s("p",[t._v(t._s(t.userInfo.uid)),s("i",{staticClass:"bi bi-lock"})])]),s("div",{staticClass:"phone"},[s("span",[t._v("手机号码")]),s("p",[t._v(t._s(t.userInfo.phone)),s("i",{staticClass:"bi bi-lock"})])]),t._m(0),t._m(1)]):t._e(),t.$store.state.isUserInfoShow?s("div",{staticClass:"saveInfo",on:{click:t.saveInfo}},[t._v(" 保存修改 ")]):t._e(),t.$store.state.isUserInfoShow?s("div",{staticClass:"logOut",on:{click:t.logOut}},[t._v(" 退出登录 ")]):t._e()])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"password"},[s("span",[t._v("密码")]),s("p",[t._v("点击修改密码"),s("i",{staticClass:"bi bi-chevron-right"})])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"address"},[s("span",[t._v("收货地址")]),s("p",[t._v("点击修改收货地址"),s("i",{staticClass:"bi bi-chevron-right"})])])}],o={data:function(){return{userInfo:"",image:"",userName:"",oldName:"",isImgChange:!1,isNameChange:!1}},created:function(){this.init()},methods:{init:function(){0!=this.$store.state.personal.userInfo.length?(this.$store.dispatch("setUserInfoShowAsync",!0),this.userInfo=this.$store.state.personal.userInfo,this.image=this.$store.state.personal.userInfo.avatar,this.userName=this.$store.state.personal.userInfo.nickname,this.oldName=this.userName):this.getInfo()},getInfo:function(){var t=this,e=this.$store.state.token;axios({method:"GET",url:"http://47.115.51.185/api/user",headers:{"Authori-zation":"Bearer "+e}}).then((function(e){200==e.data.status&&(t.userInfo=e.data.data,t.image=t.userInfo.avatar,t.userName=t.userInfo.nickname,t.oldName=t.userName,t.$store.dispatch("setUserInfoShowAsync",!0),t.$store.dispatch("personal/setUserInfoAsync",t.userInfo))}))},logOut:function(){localStorage.removeItem("token"),localStorage.removeItem("expires_time"),this.$router.push("/login")},getPhoto:function(){var t=this;this.isImgChange=!0;var e=this.$refs.image.files[0],s=new FormData;s.append("file",e);var a=this.$store.state.token;axios({method:"POST",url:"http://47.115.51.185/api/upload/image",data:s,headers:{"Authori-zation":"Bearer "+a,"Content-Type":"multipart/form-data"}}).then((function(e){200==e.data.status&&(t.image=e.data.data.url)}))},saveInfo:function(){var t=this;if(this.oldName!=this.userName||this.isImgChange){this.oldName=this.userName,this.isImgChange=!1;var e=this.$store.state.token;axios({method:"POST",url:"http://47.115.51.185/api/user/edit",data:{avatar:this.image,nickname:this.userName},headers:{"Authori-zation":"Bearer "+e}}).then((function(e){200==e.data.status&&t.saveTip("保存成功")}))}else this.noSaveTip("没有发现修改内容")},saveTip:function(t){var e=this;this.$store.dispatch("setErrorTipShowAsync",!0),this.$store.dispatch("setErrorTipAsync",t);var s=setTimeout((function(){e.$store.dispatch("setErrorTipShowAsync",!1),e.$store.state.isErrorTipShow||(clearInterval(s),e.$router.go(0))}),1e3)},noSaveTip:function(t){var e=this;this.$store.dispatch("setErrorTipShowAsync",!0),this.$store.dispatch("setErrorTipAsync",t);var s=setTimeout((function(){e.$store.dispatch("setErrorTipShowAsync",!1),e.$store.state.isErrorTipShow||clearInterval(s)}),1e3)}},beforeRouteEnter:function(t,e,s){localStorage.getItem("token")?(document.title=t.meta.title,s()):(sessionStorage.setItem("toPath",t.path),s({path:"/login"}))}},r=o,n=(s("49b9"),s("2877")),h=Object(n["a"])(r,a,i,!1,null,null,null);e["default"]=h.exports},be92:function(t,e,s){}}]);
//# sourceMappingURL=chunk-d5142b14.64d54e00.js.map